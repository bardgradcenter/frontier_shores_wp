!function($){$.fn.columnize=function(e){var t={width:400,columns:!1,buildOnce:!1,overflow:!1,doneFunc:function(){},target:!1,ignoreImageLoading:!0,columnFloat:"left",lastNeverTallest:!1,accuracy:!1,manualBreaks:!1,cssClassPrefix:""};return e=$.extend(t,e),"string"==typeof e.width&&(e.width=parseInt(e.width,10),isNaN(e.width)&&(e.width=t.width)),this.each(function(){function n(e,t){var n=t?".":"";return g.length?n+g+"-"+e:n+e}function o(t,o,i,l){for(;(u||i.height()<l)&&o[0].childNodes.length;){var a=o[0].childNodes[0];if($(a).find(n("columnbreak",!0)).length)return;if($(a).hasClass(n("columnbreak")))return;t.append(a)}if(0!==t[0].childNodes.length){var d=t[0].childNodes,r=d[d.length-1];t[0].removeChild(r);var s=$(r);if(3==s[0].nodeType){var c=s[0].nodeValue,h=e.width/18;e.accuracy&&(h=e.accuracy);for(var f,g=null;i.height()<l&&c.length;){var m=c.indexOf(" ",h);f=-1!=m?c.substring(0,c.indexOf(" ",h)):c,g=document.createTextNode(f),t.append(g),c=c.length>h&&-1!=m?c.substring(m):""}if(i.height()>=l&&null!==g&&(t[0].removeChild(g),c=g.nodeValue+c),!c.length)return!1;s[0].nodeValue=c}return o.contents().length?o.prepend(s):o.append(s),3==s[0].nodeType}}function i(e,t,l,a){if(!e.contents(":last").find(n("columnbreak",!0)).length&&!e.contents(":last").hasClass(n("columnbreak"))&&t.contents().length){var d=t.contents(":first");if(1!=d.get(0).nodeType)return;var r=d.clone(!0);d.hasClass(n("columnbreak"))?(e.append(r),d.remove()):u?(e.append(r),d.remove()):1!=r.get(0).nodeType||r.hasClass(n("dontend"))||(e.append(r),r.is("img")&&l.height()<a+20?d.remove():!d.hasClass(n("dontsplit"))&&l.height()<a+20?d.remove():r.is("img")||d.hasClass(n("dontsplit"))?r.remove():(r.empty(),o(r,d,l,a)?d.addClass(n("split")):(d.addClass(n("split")),d.children().length&&i(r,d,l,a)),0===r.get(0).childNodes.length&&r.remove()))}}function l(){if(!r.data("columnized")||1!=r.children().length){if(r.data("columnized",!0),r.data("columnizing",!0),r.empty(),r.append($("<div class='"+n("first")+" "+n("last")+" "+n("column")+" ' style='width:100%; float: "+e.columnFloat+";'></div>")),$col=r.children().eq(r.children().length-1),$destroyable=c.clone(!0),e.overflow){for(targetHeight=e.overflow.height,o($col,$destroyable,$col,targetHeight),$destroyable.contents().find(":first-child").hasClass(n("dontend"))||i($col,$destroyable,$col,targetHeight);$col.contents(":last").length&&a($col.contents(":last").get(0));){var t=$col.contents(":last");t.remove(),$destroyable.prepend(t)}for(var l="",d=document.createElement("DIV");$destroyable[0].childNodes.length>0;){var s=$destroyable[0].childNodes[0];if(s.attributes)for(var h=0;h<s.attributes.length;h++)0===s.attributes[h].nodeName.indexOf("jQuery")&&s.removeAttribute(s.attributes[h].nodeName);d.innerHTML="",d.appendChild($destroyable[0].childNodes[0]),l+=d.innerHTML}var f=$(e.overflow.id)[0];f.innerHTML=l}else $col.append($destroyable);r.data("columnizing",!1),e.overflow&&e.overflow.doneFunc&&e.overflow.doneFunc()}}function a(e){return 3==e.nodeType?/^\s+$/.test(e.nodeValue)&&e.previousSibling?a(e.previousSibling):!1:1!=e.nodeType?!1:$(e).hasClass(n("dontend"))?!0:0===e.childNodes.length?!1:a(e.childNodes[e.childNodes.length-1])}function d(){if(m=0,h!=r.width()){h=r.width();var t=Math.round(r.width()/e.width),d=e.width,f=e.height;if(e.columns&&(t=e.columns),u&&(t=c.find(n("columnbreak",!0)).length+1,d=!1),1>=t)return l();if(!r.data("columnizing")){r.data("columnized",!0),r.data("columnizing",!0),r.empty(),r.append($("<div style='width:"+Math.floor(100/t)+"%; float: "+e.columnFloat+";'></div>")),C=r.children(":last"),C.append(c.clone()),s=C.height(),r.empty();var g=s/t,v=!0,p=3,w=!1;e.overflow?(p=1,g=e.overflow.height):f&&d&&(p=1,g=f,w=!0);for(var b=0;p>b&&20>b;b++){r.empty();var y,N,C,T;try{y=c.clone(!0)}catch(x){y=c.clone()}y.css("visibility","hidden");for(var L=0;t>L;L++)N=0===L?n("first"):"",N+=" "+n("column"),N=L==t-1?n("last")+" "+N:N,r.append($("<div class='"+N+"' style='width:"+Math.floor(100/t)+"%; float: "+e.columnFloat+";'></div>"));for(L=0;L<t-(e.overflow?0:1)||w&&y.contents().length;){for(r.children().length<=L&&r.append($("<div class='"+N+"' style='width:"+Math.floor(100/t)+"%; float: "+e.columnFloat+";'></div>")),C=r.children().eq(L),w&&C.width(d+"px"),o(C,y,C,g),i(C,y,C,g);C.contents(":last").length&&a(C.contents(":last").get(0));)T=C.contents(":last"),T.remove(),y.prepend(T);L++,0===C.contents().length&&y.contents().length?C.append(y.contents(":first")):L!=t-(e.overflow?0:1)||e.overflow||y.find(n("columnbreak",!0)).length&&t++}if(e.overflow&&!w){var M=!1,z=document.all&&-1!=navigator.appVersion.indexOf("MSIE 7.");if(M||z){for(var k="",F=document.createElement("DIV");y[0].childNodes.length>0;){var H=y[0].childNodes[0];for(L=0;L<H.attributes.length;L++)0===H.attributes[L].nodeName.indexOf("jQuery")&&H.removeAttribute(H.attributes[L].nodeName);F.innerHTML="",F.appendChild(y[0].childNodes[0]),k+=F.innerHTML}var I=$(e.overflow.id)[0];I.innerHTML=k}else $(e.overflow.id).empty().append(y.contents().clone(!0))}else if(w)r.children().each(function(e){C=r.children().eq(e),C.width(d+"px"),0===e?C.addClass(n("first")):e==r.children().length-1?C.addClass(n("last")):(C.removeClass(n("first")),C.removeClass(n("last")))}),r.width(r.children().length*d+"px");else{C=r.children().eq(r.children().length-1),y.contents().each(function(){C.append($(this))});var O=C.height(),V=O-g,q=0,P=1e7,j=0,E=!1,Q=0;r.children().each(function(e){return function(t){var o=e.children().eq(t),i=o.children(":last").find(n("columnbreak",!0)).length;if(!i){var l=o.height();E=!1,q+=l,l>j&&(j=l,E=!0),P>l&&(P=l),Q++}}}(r));var S=q/Q;0===q?b=p:e.lastNeverTallest&&E?(m+=30,g+=30,b==p-1&&p++):j-P>30?g=S+30:Math.abs(S-g)>20?g=S:b=p}r.append($("<br style='clear:both;'>"))}r.find(n("column",!0)).find(":first"+n("removeiffirst",!0)).remove(),r.find(n("column",!0)).find(":last"+n("removeiflast",!0)).remove(),r.data("columnizing",!1),e.overflow&&e.overflow.doneFunc(),e.doneFunc()}}}var r=$(e.target?e.target:this),s=$(this).height(),c=$("<div></div>"),h=0,f=!1,u=e.manualBreaks,g=t.cssClassPrefix;"string"==typeof e.cssClassPrefix&&(g=e.cssClassPrefix);var m=0;if(c.append($(this).contents().clone(!0)),!e.ignoreImageLoading&&!e.target&&!r.data("imageLoaded")&&(r.data("imageLoaded",!0),$(this).find("img").length>0)){var v=function(t,n){return function(){t.data("firstImageLoaded")||(t.data("firstImageLoaded","true"),t.empty().append(n.children().clone(!0)),t.columnize(e))}}($(this),c);return $(this).find("img").one("load",v),void $(this).find("img").one("abort",v)}r.empty(),d(),e.buildOnce||$(window).resize(function(){e.buildOnce||(r.data("timeout")&&clearTimeout(r.data("timeout")),r.data("timeout",setTimeout(d,200)))})})}}(jQuery);